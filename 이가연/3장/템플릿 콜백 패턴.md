# ν…ν”λ¦Ώ/μ½λ°± ν¨ν„΄

ν…ν”λ¦Ώ/μ½λ°± ν¨ν„΄μ€ μ¤ν”„λ§μ—μ„ μ‚¬μ©ν•λ” μ „λµ ν¨ν„΄μΌλ΅ JdbcTemplate, RestTemplate, RedisTemplate λ“±μ—μ„ μ‚¬μ©λλ‹¤. ν”ν μ•„λ” GOF λ””μμΈ ν¨ν„΄μ€ μ•„λ‹κ³  **μ „λµ ν¨ν„΄μ ν™•μ¥ν** μ •λ„λ΅ μ΄ν•΄ ν•λ©΄ λλ‹¤. 

> **μ „λµ ν¨ν„΄μ΄λ€?**
> ![image](https://github.com/user-attachments/assets/f98d9641-aec8-4444-a076-fbbb45447dbe)
> λ°νƒ€μ„ μ¤‘ μ•κ³ λ¦¬μ¦ μ „λµμ„ μ„ νƒν•΄ κ°μ²΄ λ™μ‘μ„ μ‹¤μ‹κ°„μΌλ΅ λ°”λ€λ„λ΅ ν•λ” λ””μμΈ ν¨ν„΄μ΄λ‹¤.


<br>κΈ°μ΅΄μ μ „λµ ν¨ν„΄μ€ μ „λµ μ•κ³ λ¦¬μ¦ λ¶€λ¶„μ„ μ»΄νμΌ νƒ€μ„μ— ν΄λμ¤λ΅ λ§λ“  λ’¤ κµ¬ν„μ²΄λ¥Ό DIν•΄μ¤μ•Ό ν•μ§€λ§, ν…ν”λ¦Ώ μ½λ°± ν¨ν„΄μ€ λ°νƒ€μ„ νƒ€μ„μ—μ„ `μµλ… ν΄λμ¤`λ¥Ό μ΄μ©ν•΄ **λ™μ μΌλ΅ μ „λµ μ•κ³ λ¦¬μ¦μ„ μ£Όμ…**ν•λ‹¤. μ¦‰ ν…ν”λ¦Ώμ€ μ „λµ ν¨ν„΄μ—μ„ μ»¨ν…μ¤νΈλ¥Ό λ»ν•κ³ , μ½λ°±μ€ μµλ… ν΄λμ¤λ¥Ό λ§λ“¤μ–΄μ§„ λ©”μ„λ“λ¥Ό μΉ­ν•λ” κ²ƒμ΄λ‹¤. 

- **ν…ν”λ¦Ώ (Template)**
    - μ‹¤ν–‰ν•  μ „μ²΄μ μΈ λ΅μ§μ κµ¬μ΅°λ¥Ό μ •μν•λ” λ©”μ„λ“.
    - κ³ μ •λ μ‹¤ν–‰ νλ¦„κ³Ό λ°λ³µμ μΈ λ΅μ§μ„ ν¬ν•¨
    - κ°λ°μκ°€ λ³€κ²½ν•  ν•„μ”κ°€ μ—†λ” κ³µν†µμ μΈ λ΅μ§μ„ ν¬ν•¨ν•λ©°, κµ¬μ²΄μ μΈ λ™μ‘μ€ κ°λ°μκ°€ μ κ³µν•λ” μ½λ°±μ„ ν†µν•΄ κ²°μ •
- **μ½λ°± (Callback)**
    - ν…ν”λ¦Ώ λ©”μ„λ“κ°€ νΉμ • μ‹μ μ— νΈμ¶ν•λ” λ©”μ„λ“.
    - ν…ν”λ¦Ώ λ©”μ„λ“μ μ‹¤ν–‰ μ¤‘κ°„μ— κ°λ³„μ μΌλ΅ λ³€κ²½μ΄ ν•„μ”ν• λ™μ‘(μ: λ°μ΄ν„°λ² μ΄μ¤ μΏΌλ¦¬, μμ™Έ μ²λ¦¬ λ“±)μ„ μ •μ
    - μ£Όλ΅ μΈν„°νμ΄μ¤λ‚ λλ‹¤ ν‘ν„μ‹μΌλ΅ κµ¬ν„
    


<br> π’΅
***λ³µμ΅ν•μ§€λ§ λ°”λ€μ§€ μ•λ” μΌμ •ν• ν¨ν„΄μ„ κ°–λ” μ‘μ—… νλ¦„μ΄ μκ³ , κ·Έκ²ƒμ΄ μμ£Ό λ³€κ²½λλ‹¤λ©΄ ν…ν”λ¦Ώ/μ½λ°± ν¨ν„΄μ„ κ³ λ ¤ν•΄μ•Ό ν•λ‹¤.*** 



# μ½”λ“λ΅ λ³΄λ” ν…ν”λ¦Ώ/μ½λ°± ν¨ν„΄

ν…ν”λ¦Ώ ν΄λμ¤μ™€ μ½λ°± μΈν„°νμ΄μ¤λ¥Ό κ°„λ‹¨ν•κ² κµ¬ν„ν•΄λ³΄λ©΄ λ‹¤μκ³Ό κ°™λ‹¤. 

```java
// μ½λ°± μΈν„°νμ΄μ¤ μ •μ
interface Callback {
    void doSomething();  // μ½λ°± λ©”μ„λ“
}

// ν…ν”λ¦Ώ ν΄λμ¤
class Template {
    void execute(Callback callback) {
        System.out.println("=== Before Callback ===");
        callback.doSomething();  // μ½λ°± λ©”μ„λ“ νΈμ¶
        System.out.println("=== After Callback ===");
    }
}

// ν΄λΌμ΄μ–ΈνΈ μ½”λ“
public class Main {
    public static void main(String[] args) {
        Template template = new Template();
        
        // μ½λ°± λ©”μ„λ“ μ •μ λ° μ „λ‹¬
        template.execute(() -> System.out.println("This is a callback logic!"));
    }
}
```

```java
=== Before Callback ===
This is a callback logic!
=== After Callback ===
```

- **Main λ©”μ†λ“**
    - μ½λ°± λ©”μ†λ“λ¥Ό `System.out.println("This is a callback logic!")` λ΅ μ •μν•κ³  μλ‹¤.
- **μ½λ°± μΈν„°νμ΄μ¤**
    - `doSomething()`μ΄λΌλ” μ½λ°± λ©”μ†λ“λ¥Ό κ°–κ³  λ©”μΈ λ©”μ†λ“μ κµ¬ν„μ„ κΈ°λ‹¤λ¦°λ‹¤.
- **ν…ν”λ¦Ώ ν΄λμ¤**
    - μ½λ°± λ©”μ†λ“μ μ‹¤ν–‰ μ‹μ μ„ μ •μν•κ³  νΈμ¶ν•λ‹¤.

## RedisTemplateμΌλ΅ λ³΄λ” ν…ν”λ¦Ώ/μ½λ°± ν¨ν„΄

RedisTemplateμ€ Redisμ™€μ μƒνΈμ‘μ©μ—μ„ μμ£Ό λ°μƒν•λ” μ—°κ²° κ΄€λ¦¬, λ…λ Ή μ‹¤ν–‰, μμ™Έ μ²λ¦¬ λ“±μ„ κ΄€λ¦¬ν•λ” ν…ν”λ¦Ώ λ©”μ„λ“μ΄λ‹¤. RedisTemplateμ—μ„ μμ£Ό μ‚¬μ©λλ” `execute` λ…λ Ήμ–΄λ¥Ό μ‚΄ν΄λ³΄μ.

RedisTemplateμ execute λ©”μ„λ“μ λ‚΄λ¶€ κµ¬μ΅°λ” λ‹¤μκ³Ό κ°™λ‹¤. 

```java
public class RedisTemplate<K, V> extends RedisAccessor {
    
    public <T> T execute(RedisCallback<T> action) {
        RedisConnection connection = null;
        try {
		        // ν…ν”λ¦Ώμ΄ Redis μ—°κ²°μ„ κ΄€λ¦¬
            connection = getConnectionFactory().getConnection();  
            // μ½λ°± λ©”μ„λ“ νΈμ¶
            return action.doInRedis(connection);  
        } catch (Exception ex) {
            // μμ™Έ μ²λ¦¬ λ΅μ§
            throw convertRedisAccessException(ex);
        } finally {
            if (connection != null) {
                connection.close();  // λ¦¬μ†μ¤ μ •λ¦¬
            }
        }
    }
}
```

μ°λ¦¬κ°€ μ½”λ“μ—μ„ λ‹¨μν `redisTemplate.execute()` ν•λ‚λ΅ μ²λ¦¬ν•λ” κ²ƒμ€ μ‚¬μ‹¤ λ‚΄λ¶€μ—” μ΄λ¬ν• λ³µμ΅ν• μμ™Έμ²λ¦¬μ™€ Redis μ—°κ²° κ΄€λ¦¬ λ“±μ΄ μ¨μ–΄μλ‹¤. λ§μ•½ μ—¬κΈ°μ„ λ©”μ„λ“λ¥Ό μ΅°μ‘ν•κ³  μ‹¶λ‹¤λ©΄ μ½λ°± λ©”μ„λ“μΈ `action.doInRedis` λ¥Ό μ΅°μ‘ν•λ©΄ λλ” κ²ƒμ΄λ‹¤. 

```java
redisTemplate.execute(new RedisCallback<Object>() {
    @Override
    public Object doInRedis(RedisConnection connection) throws DataAccessException {
        // μ—¬κΈ°κ°€ μ½λ°± λ©”μ„λ“μ λ‚΄λ¶€
        connection.set("myKey".getBytes(), "myValue".getBytes());  // μ‚¬μ©μ μ •μ λ™μ‘
        return null;
    }
});
```

μ¦‰ λ‹¤μκ³Ό κ°™μ΄ RedisTemplate λ©”μ†λ“λ¥Ό μ‹¤ν–‰ν•λ‹¤λ©΄

```java
redisTemplate.execute((RedisConnection connection) -> {
    connection.set("myKey".getBytes(), "myValue".getBytes());
    return null;
});
```
μ΄λ” μ½λ°± λ©”μ†λ“μ connection.setμ„ μ΅°μ‘ν•¨μΌλ΅μ¨ μ‚¬μ©μκ°€ λ°μ΄ν„° μ €μ¥μ„ μ •μν•κ² λλ” κ²ƒμ΄λ‹¤. 

# ν…ν”λ¦Ώ/μ½λ°± ν¨ν„΄μ μ¥μ 

1. **μ¤‘λ³µ μ½”λ“ μ κ±° λ° μ½”λ“ μ¬μ‚¬μ©μ„± μ¦κ°€**
    1. ν…ν”λ¦Ώ λ©”μ„λ“κ°€ λ°λ³µλλ” μ‘μ—…μ„ μΊ΅μν™”ν•΄ κ΄€λ¦¬ν•¨μΌλ΅μ¨ μ½”λ“μ μ¬μ‚¬μ©μ„±μ„ λ†’μ΄κ³  μ¤‘λ³µ μ½”λ“λ¥Ό μ¤„μΈλ‹¤. 
    2. μ‚¬μ©μλ” μ΄λ΅μ¨ λ°λ³µμ μΈ μ½”λ“ μ‘μ„±μ€ μ¤„μ΄κ³  ν•„μ”μ‹ μ½λ°± λ©”μ„λ“λ§ μ¬μ •μν•λ©΄ λλ‹¤.
2. **λΉ„μ¦λ‹μ¤ λ΅μ§μ λ…ν™•ν• λ¶„λ¦¬**
    1. μ„λΉ„μ¤λ‹¨μ—λ” λ¬Έμ  νμ•…μ„ μ„ν•΄ μµλ€ν• λΉ„μ¦λ‹μ¤ λ΅μ§λ§ λ‚¨κ²¨μ•Ό ν•λ‹¤.
3. **κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬**
